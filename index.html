<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,viewport-fit=cover" />
<title>KNM â€“ Lessons 9 & 10 â€¢ Fillâ€‘in Quiz (Mobile)</title>
<style>
  :root{color-scheme:dark light}
  body{margin:0;font:16px/1.5 system-ui,Segoe UI,Roboto,Arial;background:#0b0f1c;color:#e5e7eb}
  .wrap{max-width:920px;margin:24px auto;padding:16px}
  .card{background:#0f1628;border:1px solid #1f2b44;border-radius:12px;padding:16px}
  .row{display:flex;flex-wrap:wrap;gap:12px;align-items:center}
  label{font-weight:600;color:#9ca3af}
  select,input[type=text]{background:#0b1220;border:1px solid #243041;color:#e5e7eb;padding:12px;border-radius:10px}
  button{background:#22d3ee;color:#00242a;border:0;padding:12px 16px;border-radius:10px;font-weight:700;cursor:pointer}
  button[disabled]{opacity:.6;cursor:not-allowed}
  .pill{display:inline-block;padding:4px 10px;border-radius:999px;background:#0b1220;border:1px solid #22314a;color:#9ca3af;font-size:12px;margin-right:6px}
  .prompt{font-size:26px;font-weight:800;margin:12px 0}
  .feedback{min-height:24px;margin-top:8px}
  .ok{color:#22c55e;font-weight:700}
  .bad{color:#ef4444;font-weight:700}
  .bar{height:8px;border-radius:999px;background:#1f2937;overflow:hidden;margin:14px 0}
  .bar>span{display:block;height:100%;background:linear-gradient(90deg,#06b6d4,#22c55e);width:0%}
  .small{font-size:12px;color:#9ca3af}
  @media (max-width:560px){ .row{gap:10px} .prompt{font-size:22px} button{padding:12px 14px} }
</style>
</head>
<body>
<div class="wrap">
  <h1>ðŸ‡³ðŸ‡± KNM â€“ Lessons 9 & 10 â€¢ Fillâ€‘in Quiz (Mobile)</h1>

  <div class="card">
    <div class="row" style="gap:18px">
      <div><label>Direction:</label>
        <label><input type="radio" name="dir" value="nl-en" checked> NL â†’ EN</label>
        <label><input type="radio" name="dir" value="en-nl"> EN â†’ NL</label>
      </div>
      <div>
        <label for="lesson">Lesson:</label>
        <select id="lesson">
          <option value="__ALL__">All (9 & 10)</option>
          <option>Lesson 9</option>
          <option>Lesson 10</option>
        </select>
      </div>
      <div><label><input type="checkbox" id="lenient" checked> Lenient check</label></div>
      <div style="margin-left:auto"><button id="startBtn">Start</button></div>
    </div>
    <div class="small" id="status"></div>
  </div>

  <div class="card" id="quiz" style="display:none;margin-top:12px">
    <div class="row" style="justify-content:space-between">
      <div>
        <span class="pill" id="lessonPill"></span>
        <span class="pill" id="dirPill"></span>
      </div>
      <div class="small"><span id="score">0</span> correct â€¢ <span id="progress">0/0</span></div>
    </div>
    <div class="bar"><span id="barFill"></span></div>

    <div>
      <div class="prompt" id="prompt"></div>
      <div class="row">
        <input id="answer" type="text" placeholder="Type answerâ€¦" autocomplete="off"
               autocapitalize="off" autocorrect="off" spellcheck="false" inputmode="text" />
        <button id="checkBtn">Check</button>
      </div>
      <div class="feedback" id="feedback"></div>
      <div class="small" id="meta"></div>
    </div>
  </div>
</div>

<script>
(function(){
  // ---- Data (Lessons 9 & 10) ----
  const ROWS = [
    {"lesson":"Lesson 9","nl":"de geschiedenis","en":"the history"},
    {"lesson":"Lesson 9","nl":"het gebeid","en":"the area"},
    {"lesson":"Lesson 9","nl":"de middleleeuwen","en":"the middle ages"},
    {"lesson":"Lesson 9","nl":"de leider","en":"the leader"},
    {"lesson":"Lesson 9","nl":"de lage landen","en":"the low land"},
    {"lesson":"Lesson 9","nl":"De boeren","en":"the farmer"},
    {"lesson":"Lesson 9","nl":"arm","en":"poor"},
    {"lesson":"Lesson 9","nl":"rijk mensen","en":"rich people"},
    {"lesson":"Lesson 9","nl":"muur","en":"wall"},
    {"lesson":"Lesson 9","nl":"onstonden","en":"emerged"},
    {"lesson":"Lesson 9","nl":"kastelen","en":"castle"},
    {"lesson":"Lesson 9","nl":"afval","en":"waste"},
    {"lesson":"Lesson 9","nl":"bezet","en":"occupy / busy"},
    {"lesson":"Lesson 9","nl":"Oorlog","en":"war"},
    {"lesson":"Lesson 9","nl":"macht","en":"power"},
    {"lesson":"Lesson 9","nl":"gedood","en":"died"},
    {"lesson":"Lesson 9","nl":"verzet","en":"resist"},
    {"lesson":"Lesson 9","nl":"gevochten","en":"fought"},
    {"lesson":"Lesson 9","nl":"doodgeschoten","en":"shot to death"},
    {"lesson":"Lesson 9","nl":"Verenigde","en":"united"},
    {"lesson":"Lesson 9","nl":"Het wilhelmus","en":"national anthem"},
    {"lesson":"Lesson 9","nl":"volkslied","en":"people song"},
    {"lesson":"Lesson 9","nl":"De handel","en":"the trade"},
    {"lesson":"Lesson 9","nl":"de gouden era","en":"golden era"},
    {"lesson":"Lesson 9","nl":"voeren","en":"travel"},
    {"lesson":"Lesson 9","nl":"specerijn","en":"spices"},
    {"lesson":"Lesson 9","nl":"slaven","en":"slaves"},
    {"lesson":"Lesson 9","nl":"schepen","en":"ships"},
    {"lesson":"Lesson 9","nl":"Azie","en":"asia"},
    {"lesson":"Lesson 9","nl":"betaalen","en":"pays"},
    {"lesson":"Lesson 9","nl":"gracht","en":"canal"},
    {"lesson":"Lesson 9","nl":"bewaarden","en":"saved/kept"},
    {"lesson":"Lesson 9","nl":"pakhuizen","en":"warehouse"},
    {"lesson":"Lesson 9","nl":"De Kunst","en":"the art"},
    {"lesson":"Lesson 9","nl":"beroemd","en":"famous"},
    {"lesson":"Lesson 9","nl":"musea","en":"museum"},
    {"lesson":"Lesson 9","nl":"De Nachtwacht","en":"the night wait"},
    {"lesson":"Lesson 9","nl":"eerste grondwet","en":"first law"},
    {"lesson":"Lesson 9","nl":"koninkrijk","en":"kingdom"},
    {"lesson":"Lesson 9","nl":"de arbeiders","en":"the labourers"},
    {"lesson":"Lesson 9","nl":"heel zwaar","en":"very strong"},
    {"lesson":"Lesson 9","nl":"verloren","en":"lost"},
    {"lesson":"Lesson 9","nl":"partij","en":"party"},
    {"lesson":"Lesson 9","nl":"Joden","en":"jews"},
    {"lesson":"Lesson 9","nl":"geheime kamers","en":"secret rooms"},
    {"lesson":"Lesson 9","nl":"onderduiken","en":"underground"},
    {"lesson":"Lesson 9","nl":"Een moeilijke tijd","en":"a difficult time"},
    {"lesson":"Lesson 9","nl":"verdelen","en":"divide"},
    {"lesson":"Lesson 9","nl":"welvaart","en":"welfare"},
    {"lesson":"Lesson 9","nl":"koelkast","en":"fridge"},
    {"lesson":"Lesson 9","nl":"weilanden","en":"Grassland / meadow"},
    {"lesson":"Lesson 9","nl":"de brug","en":"bridge"},
    {"lesson":"Lesson 9","nl":"allochtonen","en":"immigrants"},
    {"lesson":"Lesson 9","nl":"overstroming","en":"flood"},
    {"lesson":"Lesson 9","nl":"de eeuw","en":"the era"},
    {"lesson":"Lesson 10","nl":"Het koninkrijk","en":"kingdom"},
    {"lesson":"Lesson 10","nl":"eiland","en":"island"},
    {"lesson":"Lesson 10","nl":"bijzondere","en":"special"},
    {"lesson":"Lesson 10","nl":"de inwoners","en":"the people/ the habitants"},
    {"lesson":"Lesson 10","nl":"meerderheid","en":"majority"},
    {"lesson":"Lesson 10","nl":"minderheid","en":"minority"},
    {"lesson":"Lesson 10","nl":"Het bestuur","en":"the board"},
    {"lesson":"Lesson 10","nl":"ministers","en":"ministers"},
    {"lesson":"Lesson 10","nl":"plannen","en":"plan"},
    {"lesson":"Lesson 10","nl":"het gezicht","en":"the face"},
    {"lesson":"Lesson 10","nl":"gouden koets","en":"golden coach"},
    {"lesson":"Lesson 10","nl":"troonrede","en":"speech from the throne"},
    {"lesson":"Lesson 10","nl":"de leider","en":"the leader"},
    {"lesson":"Lesson 10","nl":"tussen","en":"between"},
    {"lesson":"Lesson 10","nl":"staatsecretaris","en":"state secretary"},
    {"lesson":"Lesson 10","nl":"het kabinet","en":"the cabinet"},
    {"lesson":"Lesson 10","nl":"taak","en":"task"},
    {"lesson":"Lesson 10","nl":"vergaderingen","en":"meetings"},
    {"lesson":"Lesson 10","nl":"voorstel","en":"proposal"},
    {"lesson":"Lesson 10","nl":"waar","en":"true"},
    {"lesson":"Lesson 10","nl":"niet waar","en":"not true"},
    {"lesson":"Lesson 10","nl":"gebouwd","en":"built"},
    {"lesson":"Lesson 10","nl":"gementeeraad","en":"gemente board"},
    {"lesson":"Lesson 10","nl":"de burgemeester","en":"the mayor"},
    {"lesson":"Lesson 10","nl":"deelgementeen","en":"shared municiplaity"},
    {"lesson":"Lesson 10","nl":"wetten","en":"laws"},
    {"lesson":"Lesson 10","nl":"veiligheid","en":"safety"},
    {"lesson":"Lesson 10","nl":"Het waterschap","en":"water authority"},
    {"lesson":"Lesson 10","nl":"de ideeen","en":"the ideas"},
    {"lesson":"Lesson 10","nl":"tweedekamer","en":"second chamber /room"},
    {"lesson":"Lesson 10","nl":"strenge regels","en":"strictrules"},
    {"lesson":"Lesson 10","nl":"linkse en rechtse","en":"left and right"},
    {"lesson":"Lesson 10","nl":"de reclame","en":"the advertisement"},
    {"lesson":"Lesson 10","nl":"lijstrekker","en":"party leader"},
    {"lesson":"Lesson 10","nl":"stembiljet","en":"ballot paper"},
    {"lesson":"Lesson 10","nl":"De uitslag","en":"the result"},
    {"lesson":"Lesson 10","nl":"Verkiezingen","en":"elections"},
    {"lesson":"Lesson 10","nl":"godsdienst","en":"religion"},
    {"lesson":"Lesson 10","nl":"strijd","en":"fight"},
    {"lesson":"Lesson 10","nl":"hoofddoek","en":"head scarf"},
    {"lesson":"Lesson 10","nl":"de rechter","en":"the judge"},
    {"lesson":"Lesson 10","nl":"staking","en":"strike"}
  ];

  // ---- Elements & helpers ----
  const status=document.getElementById('status');
  const startBtn=document.getElementById('startBtn');
  const dirRadios=[...document.querySelectorAll('input[name=dir]')];
  const lenientChk=document.getElementById('lenient');
  const lessonSel=document.getElementById('lesson');

  const quiz=document.getElementById('quiz');
  const lessonPill=document.getElementById('lessonPill');
  const dirPill=document.getElementById('dirPill');
  const scoreEl=document.getElementById('score');
  const progressEl=document.getElementById('progress');
  const barFill=document.getElementById('barFill');

  const promptEl=document.getElementById('prompt');
  const answerEl=document.getElementById('answer');
  const checkBtn=document.getElementById('checkBtn');
  const feedback=document.getElementById('feedback');
  const meta=document.getElementById('meta');

  let queue=[], idx=0, score=0, autoTimer=null;

  function getDir(){ return dirRadios.find(r=>r.checked).value; }
  function normalize(s){ return (s||'').toLowerCase().replace(/[()\[\]{}]/g,'').replace(/\s+/g,' ').trim(); }
  function stripArticles(s){ return s.replace(/^(de|het|the|a|an)\s+/i,'').trim(); }
  function normalizeForCompare(s){ let t=normalize(s); if(lenientChk.checked) t=stripArticles(t); return t; }
  function splitVariants(s){ let t=(s||'').replace(/\n/g,' ').replace(/\s{2,}/g,' ').replace(/\((.*?)\)/g,'').trim(); const p=t.split(/\s*[,;\/\|]\s*/).map(x=>x.trim()).filter(Boolean); return p.length?p:[t]; }
  function isCorrect(user, answers){ const u=normalizeForCompare(user); return answers.some(a=>normalizeForCompare(a)===u); }
  function sampleRows(){ const choice=lessonSel.value; return (choice==='__ALL__')? ROWS.slice() : ROWS.filter(r=>r.lesson===choice); }

  function buildQueue(dir){
    const items = sampleRows();
    const q=[]; items.forEach(r=>{
      const nlV=splitVariants(r.nl), enV=splitVariants(r.en);
      const nlA=new Set(), enA=new Set();
      nlV.forEach(v=>{ nlA.add(v); nlA.add(stripArticles(v)); });
      enV.forEach(v=>{ enA.add(v); enA.add(stripArticles(v)); });
      if(dir==='nl-en') q.push({prompt:nlV[0], answers:[...enA], lesson:r.lesson});
      else q.push({prompt:enV[0], answers:[...nlA], lesson:r.lesson});
    });
    for(let i=q.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [q[i],q[j]]=[q[j],q[i]]; }
    return q;
  }

  function updateProgress(){
    progressEl.textContent=`${idx+1}/${queue.length}`;
    barFill.style.width=(Math.round(idx/Math.max(1,queue.length)*100))+'%';
    scoreEl.textContent=score;
  }

  function scheduleNext(delayMs=0){
    clearTimeout(autoTimer);
    autoTimer=setTimeout(()=>{ idx++; load(); }, delayMs);
  }

  function load(){
    feedback.textContent=''; meta.textContent='';
    answerEl.disabled=false; checkBtn.disabled=false;
    if(idx>=queue.length){
      promptEl.textContent='Finished! ðŸŽ‰';
      feedback.innerHTML = `<b>Score:</b> ${score} / ${queue.length}`;
      answerEl.disabled=true; checkBtn.disabled=true; barFill.style.width='100%';
      return;
    }
    const q=queue[idx];
    promptEl.textContent=q.prompt;
    answerEl.value='';
    // iOS sometimes ignores immediate focus; defer a tick.
    setTimeout(()=>{ try{ answerEl.focus(); }catch{} }, 0);
    lessonPill.textContent = q.lesson;
    updateProgress();
  }

  function start(){
    idx=0; score=0; const dir=getDir();
    dirPill.textContent=(dir==='nl-en'?'NL â†’ EN':'EN â†’ NL');
    queue = buildQueue(dir);
    if(!queue.length){ status.textContent='No items found for this selection.'; return; }
    const l = lessonSel.value==='__ALL__'?'All (9 & 10)':lessonSel.value;
    lessonPill.textContent = l;
    quiz.style.display=''; load();
  }

  // Add touch listeners so taps work inside WhatsAppâ€™s viewer
  startBtn.addEventListener('click', start, {passive:true});
  startBtn.addEventListener('touchend', (e)=>{ e.preventDefault(); start(); }, {passive:false});

  function onCheck(){
    const q=queue[idx]; const ok=isCorrect(answerEl.value,q.answers);
    if(ok) score++;
    feedback.innerHTML = ok ? '<span class="ok">Correct!</span>'
                            : '<span class="bad">Wrong.</span> Correct: <b>'+q.answers[0]+'</b>';
    answerEl.disabled=true; checkBtn.disabled=true;
    if(ok){ idx++; load(); } else { scheduleNext(3000); }
  }

  checkBtn.addEventListener('click', onCheck, {passive:true});
  checkBtn.addEventListener('touchend', (e)=>{ e.preventDefault(); onCheck(); }, {passive:false});
  answerEl.addEventListener('keydown',(e)=>{ if(e.key==='Enter') onCheck(); });

  status.textContent=`Loaded Lessons 9 & 10 â€“ ${ROWS.length} items.`;
})();
</script>
</body>
</html>
